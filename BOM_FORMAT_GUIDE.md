# 工程BOM表格式說明

## 概述

本工具完全符合工程BOM表的編排需求,確保零件清單完整、準確、易於追蹤。

---

## 核心編排規則

### ✅ 規則1: 按數字大小排序

**說明**: 所有零件按照編號從小到大排列

**範例**:
```
正確排序:
C1, C2, C3, C5, C5, C6, C10, C15...

錯誤排序:
C1, C10, C15, C2, C3, C5, C6... ❌
```

### ✅ 規則2: 每個零件都顯示

**說明**: 無論出現幾次,每次都單獨列出,不合併

**範例**:
```
BOM表識別到:
- C51 (圖片1)
- C51 (圖片2)
- C51 (圖片3)

顯示結果:
序號1: C51 (相同: C47,C52,C56) - 圖片1
序號2: C51 (相同: C47,C52,C56) - 圖片2 ✅
序號3: C51 (相同: C47,C52,C56) - 圖片3 ✅

不會合併成:
C51 x3 ❌
```

### ✅ 規則3: 相同規格標註

**說明**: 每個零件後面括號註明相同規格的其他零件

**範例**:
```
C47 (相同: C51, C52, C56)
C51 (相同: C47, C52, C56)
C52 (相同: C47, C51, C56)
C56 (相同: C47, C51, C52)
```

**重複出現也標註**:
```
第1次: C51 (相同: C47, C52, C56)
第2次: C51 (相同: C47, C52, C56) ✅ 重複標註
第3次: C51 (相同: C47, C52, C56) ✅ 重複標註
```

### ✅ 規則4: 明確標示缺號

**說明**: 列出編號序列中缺失的編號

**範例**:
```
識別到的編號: C1, C2, C4, C5, C7

缺失編號: C3, C6

完整顯示:
C1 ✓
C2 ✓
C3 ❌ 缺失
C4 ✓
C5 ✓
C6 ❌ 缺失
C7 ✓
```

---

## Excel報表結構

### 工作表1: 完整零件清單 ⭐

**用途**: 主要工作表,包含所有零件資訊

**欄位說明**:

| 欄位 | 說明 | 範例 |
|-----|------|------|
| 序號 | 流水號 | 1, 2, 3... |
| 零件編號 | 零件名稱 | C47, R51, D10 |
| 規格值 | 零件規格 | 560u, 10kΩ, 1N4148 |
| 相同規格零件 | 相同規格標註 | (相同: C51,C52,C56) |
| 來源圖片 | 識別來源 | 圖片1, 圖片2 |
| 備註 | 手動備註欄 | (空白) |

**特點**:
- ✅ 每個零件單獨一行
- ✅ 重複出現也會重複列出
- ✅ 按零件類型和編號排序
- ✅ 每次都標註相同規格

**示例**:
```
序號 | 零件編號 | 規格值 | 相同規格零件        | 來源圖片 | 備註
-----|---------|--------|-------------------|---------|-----
1    | C1      | 100u   |                   | 圖片1   |
2    | C2      | 100u   |                   | 圖片1   |
3    | C3      | 470u   | (相同: C10,C15)   | 圖片1   |
4    | C3      | 470u   | (相同: C10,C15)   | 圖片2   | ← 重複
5    | C5      | 100u   |                   | 圖片1   |
6    | C10     | 470u   | (相同: C3,C15)    | 圖片1   |
7    | C15     | 470u   | (相同: C3,C10)    | 圖片2   |
8    | R1      | 10kΩ   |                   | 圖片1   |
9    | R2      | 10kΩ   | (相同: R5,R8)     | 圖片1   |
...
```

### 工作表2: 缺號統計

**用途**: 快速查看缺失編號統計

**欄位說明**:

| 欄位 | 說明 |
|-----|------|
| 零件類型 | C系列、R系列等 |
| 總數量(含重複) | 總共出現次數 |
| 唯一數量 | 去重後數量 |
| 缺失數量 | 缺號個數 |
| 缺失編號列表 | 完整缺號清單 |

**示例**:
```
零件類型 | 總數量 | 唯一數量 | 缺失數量 | 缺失編號列表
--------|-------|---------|---------|------------------
C系列   | 52    | 45      | 8       | C3,C8,C12,C22,C85,C90,C95,C100
R系列   | 38    | 32      | 5       | R5,R12,R18,R91,R100
D系列   | 15    | 12      | 2       | D5,D10
Q系列   | 8     | 8       | 1       | Q3
```

### 工作表3-N: 各系列詳細表

**用途**: 每個零件系列的完整分析

**欄位說明**:

| 欄位 | 說明 |
|-----|------|
| 編號 | 零件編號 |
| 出現次數 | 重複次數 |
| 規格值 | 零件規格 |
| 相同規格 | 相同規格零件 |
| 狀態 | 已找到/缺失 |

**C系列詳細表示例**:
```
編號 | 出現次數 | 規格值 | 相同規格       | 狀態
-----|---------|--------|---------------|--------
C1   | 1       | 100u   |               | 已找到
C2   | 1       | 100u   |               | 已找到
C3   | 2       | 470u   | C10,C15       | 已找到
C4   | 0       |        |               | ❌ 缺失
C5   | 1       | 100u   |               | 已找到
C6   | 0       |        |               | ❌ 缺失
C7   | 1       | 220u   |               | 已找到
C8   | 0       |        |               | ❌ 缺失
...
```

---

## 實際應用場景

### 場景1: 採購清單

**需求**: 需要採購缺失零件

**使用方法**:
1. 打開「缺號統計」工作表
2. 查看「缺失編號列表」欄位
3. 複製缺號清單
4. 轉交採購部門

**範例**:
```
採購需求:
- C系列缺: C3, C8, C12, C22, C85
- R系列缺: R5, R12, R18, R91
```

### 場景2: 裝配檢查

**需求**: 裝配時確認每個零件是否齊全

**使用方法**:
1. 打開「完整零件清單」工作表
2. 按序號逐一核對
3. 在「備註」欄位標記裝配狀態

**範例**:
```
序號 | 零件編號 | 備註
-----|---------|--------
1    | C1      | ✓ 已裝配
2    | C2      | ✓ 已裝配
3    | C3      | ✓ 已裝配
4    | C3      | ⏳ 待裝配  ← 第二個C3
```

### 場景3: 重複零件追蹤

**需求**: 確認哪些零件規格相同,可共用

**使用方法**:
1. 查看「相同規格零件」欄位
2. 識別規格相同的零件組
3. 統一採購或替換

**範例**:
```
發現:
C47, C51, C52, C56 都是 560u
→ 可統一採購 560u 電容 4個

R2, R5, R8 都是 10kΩ
→ 可統一採購 10kΩ 電阻 3個
```

### 場景4: 版本差異比對

**需求**: 比較不同版本BOM表差異

**使用方法**:
1. 分別處理兩個版本
2. 匯出兩份Excel
3. 使用Excel比對功能
4. 識別增減零件

**範例**:
```
版本A: C1~C50 (無缺號)
版本B: C1~C52 (新增C51,C52)

差異: 新增了2個零件
```

---

## 常見問題

### Q1: 為什麼要重複顯示相同零件?

**A**: 工程需求!

原因:
1. **追蹤來源**: 每次出現可能來自不同圖片/位置
2. **裝配確認**: 確保每個位置都有裝零件
3. **數量統計**: 清楚知道總共需要幾個
4. **檢驗記錄**: 每個零件單獨記錄檢驗狀態

### Q2: 相同規格標註會不會太長?

**A**: 不會,這是特意設計的

優點:
1. **一目了然**: 不用跳到別的地方查
2. **方便採購**: 知道同規格零件有哪些
3. **避免錯誤**: 不會漏掉相同規格的零件

### Q3: 如何快速找到缺號?

**A**: 三種方法

方法1: **缺號統計**工作表
- 最快速,直接列出所有缺號

方法2: **各系列詳細表**
- 查看「狀態」欄位,找❌標記

方法3: **完整零件清單**
- 用Excel篩選功能

### Q4: 能不能只顯示唯一零件?

**A**: 不符合工程需求

本工具設計目標:
- ✅ 完整記錄每個零件出現
- ✅ 追蹤重複和來源
- ✅ 符合工程BOM表標準

如需去重,可在Excel中手動處理:
1. 複製「完整零件清單」
2. 使用Excel「刪除重複項」功能

### Q5: 缺號太多怎麼辦?

**A**: 正常現象

常見情況:
1. **跳號編排**: 設計時故意跳號預留
2. **分批裝配**: 某些零件暫不使用
3. **識別錯誤**: OCR可能漏識

建議:
- 查看「OCR原始文字」確認
- 重新拍照清晰區域
- 手動補充缺失資訊

---

## 最佳實踐

### 1. 拍照技巧

**建議**:
- 📸 保持水平（系統會自動矯正±10°）
- 💡 光線充足,避免陰影
- 🎯 一次拍一個區域,多張圖片
- ✅ 確保文字清晰可見

### 2. 處理流程

**步驟**:
1. 上傳/拍攝多張圖片
2. 點擊「開始辨識」
3. 等待處理完成
4. 查看網頁結果
5. 點擊「匯出Excel」
6. 在Excel中進一步處理

### 3. Excel使用技巧

**建議操作**:
1. **凍結首行**: 方便捲動查看
2. **設置篩選**: 快速查找特定零件
3. **條件格式**: 突出顯示缺失零件
4. **添加備註**: 記錄裝配/檢驗狀態
5. **保存多版本**: 記錄處理歷史

### 4. 數據驗證

**檢查清單**:
- [ ] 零件總數是否正確
- [ ] 缺號是否合理
- [ ] 相同規格標註是否準確
- [ ] 圖片來源是否清楚
- [ ] 有無識別錯誤

---

## 技術說明

### 數據結構

每個零件存儲以下資訊:
```javascript
{
    prefix: "C",           // 零件類型
    number: 47,            // 編號
    fullName: "C47",       // 完整名稱
    imageIndex: 1,         // 來源圖片
    value: "560u",         // 規格值
    sameAs: ["C51","C52","C56"]  // 相同規格零件
}
```

### 排序邏輯

1. 按零件類型排序（R→C→D→Q→L→U→其他）
2. 同類型按編號數字排序
3. 保留原始出現順序

### 相同規格識別

1. 提取零件編號和規格值
2. 標準化規格值（去空格、統一大小寫）
3. 建立規格值到零件列表的映射
4. 為每個零件標註相同規格零件

---

## 總結

本工具完全實現了工程BOM表的編排需求:

✅ 按數字大小排序
✅ 每個零件都顯示（含重複）
✅ 標註相同規格零件
✅ 重複標註（每次出現都標）
✅ 明確標示缺號

**適用場景**:
- 電子產品製造
- PCB裝配
- 零件採購
- 品質檢驗
- 版本管理

**輸出格式**:
- Excel工程BOM表
- 適合打印
- 易於編輯
- 標準格式

---

**版本**: v4.2.0
**更新日期**: 2025-11-23
**狀態**: ✅ 完整實現
