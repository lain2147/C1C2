# 快速開始指南

## 🚀 立即使用

1. **開啟應用**
   - 用瀏覽器打開 `index.html`
   - 支援 Chrome, Edge, Firefox, Safari

2. **上傳或拍照**
   - 點擊「上傳圖片」選擇文件
   - 或點擊「拍照」使用相機

3. **開始辨識**
   - 點擊「開始辨識」按鈕
   - 系統自動進行：
     - ✨ 圖片矯正
     - 🔧 圖片增強
     - 🔍 OCR辨識
     - 📊 零件解析

4. **查看結果**
   - 零件清單
   - 缺失編號
   - 相同規格零件
   - 性能統計

5. **匯出報表**
   - 點擊「匯出Excel」
   - 獲得完整分析報表

---

## 📸 拍照建議

### 最佳拍照角度
```
                相機
                 📱
                 ↓
        ┌───────────────┐
        │  BOM 表       │
        │  C1  C2  C3   │  ← 保持水平
        │  R1  R2  R3   │  ← 光線均勻
        │  L1  L2  L3   │  ← 無反光
        └───────────────┘
```

### 拍照檢查清單
- ✅ 光線充足（避免陰影）
- ✅ 文字清晰（對焦準確）
- ✅ 無反光（避免閃光燈）
- ✅ 角度正確（±10°以內，系統會自動矯正）
- ✅ 包含完整表格（不要裁切邊緣）

---

## 🎯 處理流程說明

### 完整流程
```
上傳/拍照
    ↓
[步驟1] 圖片矯正 ✨NEW
    ├─ 檢測左側邊緣
    ├─ 計算傾斜角度
    ├─ 自動旋轉
    └─ 智能裁切
    ↓
[步驟2] 圖片增強
    ├─ 壓縮（如果>2MB）
    ├─ 灰度化
    ├─ 對比度增強
    └─ 二值化
    ↓
[步驟3] OCR辨識
    ├─ 並行處理（≥3張圖）
    └─ 文字識別
    ↓
[步驟4] 零件解析
    ├─ 編號提取
    ├─ 缺失檢測
    └─ 分組分析
    ↓
顯示結果 + 匯出Excel
```

### 處理時間參考
| 圖片數量 | 預估時間 | 模式 |
|---------|---------|------|
| 1張 | 3-5秒 | 串行 |
| 3張 | 8-12秒 | 並行 |
| 5張 | 12-18秒 | 並行 |
| 10張 | 20-30秒 | 並行 |

---

## 💡 使用技巧

### 1. 多張圖片處理
**建議**：每次上傳3-10張圖片
- 少於3張：使用串行處理
- 3張以上：自動啟用並行處理（速度提升50%）
- 超過10張：建議分批處理

### 2. 圖片品質優化
**自動處理**：
- 大圖片（>2MB）自動壓縮
- 傾斜圖片自動矯正（±10°）
- 對比度自動增強

**建議手動處理**：
- 超過10°傾斜：重新拍照
- 嚴重模糊：提高相機解析度
- 反光嚴重：調整光源

### 3. 提升辨識準確度
**環境準備**：
- 📸 使用後置相機（通常更清晰）
- 💡 使用自然光（避免閃光燈）
- 📏 保持30-50cm距離
- 🎯 確保文字佔畫面60%以上

**拍照後檢查**：
- 放大查看文字是否清晰
- 確認沒有手震模糊
- 檢查邊緣是否完整

---

## 🔍 查看處理詳情

### 控制台輸出
按 `F12` 打開開發者工具，查看詳細處理日誌：

```
====== 預處理圖片 1/3 ======
步驟1: 正在矯正圖片角度和裁切...
原始圖片尺寸: 1920x1080
檢測到 186 個左側邊緣點
過濾後剩餘 178 個有效點
計算出旋轉角度: 3.42°
✓ 圖片已矯正 3.42°
✓ 圖片已智能裁切

步驟2: 圖片較大，正在壓縮...
步驟3: 正在增強圖片品質...

✓ 所有圖片預處理完成！

=== OCR辨識圖片 1 ===
OCR完成，耗時: 2.31秒

總處理時間: 8.45秒
平均每張: 2.82秒
```

### 性能統計面板
辨識完成後自動顯示：
- 🔧 處理模式（串行/並行）
- ⏱️ 總處理時間
- 📊 平均每張時間
- ✅ OCR準確度

---

## ❓ 常見問題快速解答

### Q: 辨識不準確？
**檢查項目**：
1. 圖片是否清晰
2. 文字是否完整
3. 光線是否充足
4. 查看控制台是否有錯誤

**解決方案**：
- 重新拍照（確保清晰）
- 調整光線（避免陰影）
- 使用更高解析度

### Q: 處理速度慢？
**優化建議**：
1. 壓縮圖片（<2MB）
2. 一次處理3-10張（啟用並行）
3. 使用性能較好的瀏覽器（Chrome/Edge）
4. 關閉其他標籤頁

### Q: 缺失某些零件編號？
**可能原因**：
1. OCR未識別（文字模糊）
2. 編號格式不標準
3. 表格結構複雜

**解決方案**：
- 放大該區域重新拍照
- 確保文字清晰可見
- 查看Excel原始文字確認

### Q: 如何關閉自動矯正？
修改 `app.js` 第10行：
```javascript
let enableImageAlignment = false; // 關閉矯正
```

---

## 📊 Excel報表說明

### 報表結構
下載的Excel包含多個工作表：

1. **摘要表**
   - 零件類型統計
   - 總數量
   - 缺失編號
   - 相同值分組

2. **各零件詳細表**（如：C系列、R系列）
   - 完整編號列表
   - 狀態（已找到/缺失）

3. **相同值分組表**
   - 同規格零件分組
   - 來源圖片
   - 所在行數

4. **OCR原始文字**
   - 各圖片的識別文字
   - 用於問題診斷

### 如何使用報表
1. **快速查看**：打開「摘要」表
2. **詳細分析**：查看各零件詳細表
3. **採購清單**：使用「缺失編號」欄位
4. **規格核對**：查看「相同值分組」表

---

## 🎓 進階功能

### 批次處理技巧
**場景**：處理大量BOM表（>20張）

**步驟**：
1. 分組處理（每組10張）
2. 分別匯出Excel
3. 手動合併結果

**原因**：避免瀏覽器內存不足

### 性能調優
**Worker數量調整** (`app.js:251`):
```javascript
const workerPool = new OCRWorkerPool(3); // 改為3個Worker
```

**適用場景**：
- CPU核心數 > 4
- 內存充足（>8GB）
- 處理大量圖片

---

## 📞 獲取幫助

### 問題診斷
1. 打開控制台（F12）
2. 查看錯誤信息
3. 截圖報告問題

### 文檔資源
- `README.md` - 完整說明文檔
- `PERFORMANCE_OPTIMIZATION.md` - 性能優化詳解
- `IMAGE_ALIGNMENT_GUIDE.md` - 矯正功能技術文檔

### 反饋渠道
如有問題或建議，請查看項目的問題追蹤系統。

---

**享受使用！** 🎉

如果這個工具幫到您，歡迎分享給更多人使用！
